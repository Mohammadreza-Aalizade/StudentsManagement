from bot.Logger import Logger

db_file = "students_management.db"
bot_token = '5595352211:AAESfGZLpQWxvZPOoCUAV9HYEytDKcfrJ4Y'
glogger = Logger("./log.txt")


class TXT:
    err_unable = 'ูุชุงุณูุงูู ูุดฺฉู ูพุด ุงูุฏู ู ูุนูุง ุงูฺฉุงู ุงุฑุณุงู ูพุงู ูุฌูุฏ ูุฏุงุฑุฏ.'
    sent_to_teacher = 'ูพุงู ุดูุง ุจุง ููููุช ุชุญูู ุงุณุชุงุฏ ุดุฏ.'
    you_have_new_messge = 'ุดูุง ฺฉ ูพุงู ุฌุฏุฏ ุงุฒ ุทุฑู ุฏุงูุดุฌู ุจุง ุดูุงุฑู ุฏุงูุดุฌู <b>{sid}</b> ุฏุฑ ุฏุฑุณ <b>{cname}</b> ุฏุงุฑุฏ.'
    enter_your_text_or_file = 'ูุทูุง ูุชูุ ูุงู ุง ููุณ ููุฑุฏ ูุธุฑ ุฑุง ุจูุฑุณุชุฏุ ฺฉู ูุญุชูุง ูุงุจู ุงุฑุณุงู ุดูุง ุจุงุฏ ุฏุฑ ูุงูุจ ฺฉ ูพุงู ุจุงุดุฏ.\n\nุงููู ูพุงู ฺฉู ุจูุฑุณุชุฏ ูุณุชููุง ุจุฑุง ุงุณุชุงุฏ ุงุฑุณุงู ุฎูุงูุฏ ุดุฏ. ุจุฑุง ูุบู <b>/cancel</b> ุฑุง ุจูุฑุณุชุฏ.'
    login_or_signup = "<b>ุซุจุช ูุงู ุง ูุฑูุฏ</b>\n\n<i><b>ูุฑูุฏ</b></i>: ุจุฑุง ูุฑูุฏ  ุจู ุญุณุงุจ ฺฉุงุฑุจุฑ ุฏุฑ ฺฉ ูพุงูุ ุฏุฑ ุฎุท ุงูู ุดูุงุฑู ฺฉุงุฑุจุฑ ู ุฏุฑ ุฎุท ุฏูู ุฑูุฒ ุฑุง ูุงุฑุฏ ฺฉูุฏ.\n\n<i><b>ุซุจุช ูุงู</b></i>: ุจุฑุง ุซุจุช ูุงู ุฏุงูุดุฌู ุฏุฑ ฺฉ ูพุงูุ ุฏุฑ ุฎุท ุงูู ุดูุงุฑู ุฏุงูุดุฌูุ ุฏุฑ ุฎุท ุฏูู ูุงู ฺฉุงููุ ุฏุฑ ุฎุท ุณูู ุฑุดุชู ู ุฏุฑ ุฎุท ุขุฎุฑ ุฑูุฒ ูุฑูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ."
    student_wrong_password = "โ ุฑูุฒ ูุฑูุฏ ุฏุงูุดุฌู ุงุดุชุจุงู ุงุณุช ูุทูุง ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ\n/start"
    teacher_wrong_password = "โ ุฑูุฒ ูุฑูุฏ ุงุณุชุงุฏ ุงุดุชุจุงู ุงุณุช ูุทูุง ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ\n/start"
    no_account_matched = "โ๏ธ ูฺ ุญุณุงุจ ูุทุงุจู ุงุทูุงุนุงุช ุดูุง ูุฌูุฏ ูุฏุงุฑุฏุ ูุทูุง ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ\n/start"
    login_successful = "โ ุดูุง ุจุง ููููุช ูุงุฑุฏ ุญุณุงุจ ฺฉุงุฑุจุฑ %s ุดุฏุฏ"
    logout_successfully = "โ ุดูุง ุจุง ููููุช ุงุฒ ุญุณุงุจ ฺฉุงุฑุจุฑ %s ุฎุงุฑุฌ ุดุฏุฏ"
    err_id_must_be_digits = "โ ุดูุงุฑู ฺฉุงุฑุจุฑ ุจุงุฏ ุนุฏุฏ ุจุงุดุฏุ ูุทูุง ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ\n/start"
    student_main_menu_title = "<b>ูุงู</b>: {name}\n<b>ุดูุงุฑู ุฏุงูุดุฌูโ</b>: {s_id}\n<b>ุชุนุฏุงุฏ ุฏุฑุณ ูุง ุงุฎุฐ ุดุฏู</b>: {c_cnt}\n"
    open_students_channel = "โ๏ธ ูุฑูุฏ ุจู ฺฉุงูุงู ุงู ุฏุฑุณ"
    back = "ุจุงุฒฺฏุดุช โฌ๏ธ"
    message_teacher = 'ูพุงู ุจู ุงุณุชุงุฏ โ๏ธ'
    logout = "ุฎุฑูุฌ ุงุฒ ุญุณุงุจ ฺฉุงุฑุจุฑ โฌ๏ธ"
    take_new_course = "โ ุงุฎุฐ ุฏุฑุณ ุฌุฏุฏ"
    err_login_again = "ูุดฺฉู ุฑุฎ ุฏุงุฏุ ุฏูุจุงุฑู ูุงุฑุฏ ุดูุฏ \n/start"
    err_duplicate_s_id = "โ๏ธ ุฏุฑ ุญุงู ุญุงุธุฑ ฺฉ ุญุณุงุจ ฺฉุงุฑุจุฑ ุจุฑุง ุดูุงุฑู ุฏุงูุดุฌู {s_id} ููุฌูุฏ ุงุณุชุ ูุทูุง ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ.\n/start"
    give_course_id_to_take = 'ูุทูุง ุดูุงุฑู ุฏุฑุณ ฺฉู ูุฎูุงูุฏ ุงุฎุฐ ฺฉูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ. ุจุฑุง ูุบู ุนููุงุช  <b>/cancel</b> ุฑุง ุงุฑุณุงู ฺฉูุฏ.'
    err_enter_course_id = "ูุทูุง ุดูุงุฑู ุฏุฑุณ ฺฉู ูุฎูุงูุฏ ุงุฎุฐ ฺฉูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ"
    err_enter_message = 'ูุชู ูพุงู ุฑุง ุงุฑุณุงู ฺฉูุฏ'
    err_course_not_found = "ุฏุฑุณ ฺฉู ูุตุฏ ุงุฎุฐ ุขู ุฑุง ุฏุงุฑุฏ ูุฌูุฏ ูุฏุงุฑุฏุ ูุทูุง ุฏุฑ ูุงุฑุฏ ฺฉุฑุฏู ุดูุงุฑู ุฏุฑุณ ุฏูุช ฺฉูุฏ."
    err_course_not_exist = 'ุฏุฑุณ ููุฑุฏ ูุธุฑ ุญุฐู ุดุฏู ุงุณุช'
    teacher_not_login = 'ูุชุงุณูุงูู ุฏุฑุญุงู ุญุงุถุฑ ูฺ ุญุณุงุจ ุชูฺฏุฑุงู ุฏุงุฎู ุญุณุงุจ ฺฉุงุฑุจุฑ ุงุณุชุงุฏ ุงู ุฏุฑุณ ูุณุช.'
    course_taken_successfully = "โ ุฏุฑุณ ููุฑุฏ ูุธุฑ ุจุง ููููุช ุงุฎุฐ ุดุฏ."
    student_see_course = "<b>ูุงู ุฏุฑุณ</b>: {name}\n<b>ุชุนุฏุงุฏ ูุงุญุฏ</b>: {units}\n<b>ูุงู ุงุณุชุงุฏ</b>: {teacher}\n<b>ุชุงุฑุฎ ุงุฎุฐ</b>: {date}\n<b>ููุฑู</b>: {mark}\n\n<b>ุงุทูุงุนู</b>: {notif}"
    err_duplicate_course = "ุดูุง ุงู ุฏุฑุณ ุฑุง ูุจูุง ฺฉ ุจุงุฑ ุงุฎุฐ ฺฉุฑุฏุฏ."

    teacher_main_menu_title = "<b>ูุงู</b>: {name}\n<b>ุดูุงุฑู ุงุณุชุงุฏ</b>: {t_id}\n<b>ุชุนุฏุงุฏ ุฏุฑุณ ูุง</b>: {c_cnt}\n"
    give_new_course_info = 'ูุทูุง ุงุทูุงุนุงุช ุฏุฑุณ ุฌุฏุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ ุง ุจุฑุง ูุบู <b>/cancel</b> ุฑุง ุจูุฑุณุชุฏ. ุงุทูุงุนุงุช ุจุงุฏ ููุท ุฏุฑ ฺฉ ูพุงู ุจู ุทูุฑ ฺฉู ุฏุฑ ุฎุท ุงูู ูุงู ุฏุฑุณุ ุฏุฑ ุฎุท ุฏูู ุชุนุฏุงุฏ ูุงุญุฏ ุขู ุจุงุดุฏ ุงุฑุณุงู ุดูุฏ.'
    err_enter_new_course_info = 'ูุทูุง ุงุทูุงุนุงุช ุฏุฑุณ ุฌุฏุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ'
    err_wrong_course_info = 'โ ุงุทูุงุนุงุช ุฏุฑุณ ุฌุฏุฏ ุตุญุญ ูุณุช'
    err_wrong_course_units = 'โ ุชุนุฏุงุฏ ูุงุญุฏ ุฏุฑุณ ุตุญุญ ูุณุช'
    course_created_successfully = 'โ ุฏุฑุณ ุจุง ููููุช ุณุงุฎุชู ุดุฏ'
    change_marks = '๐ ุชุบุฑ ููุฑู ุฏุงูุดุฌูุงู'
    delete_student = 'โ ุญุฐู ฺฉ ุฏุงูุดุฌู'
    send_broadcast = '๐จ ุชุบุฑ ุงุทูุงุนู'
    new_poll = '๐ ูุธุฑุณูุฌ ุฌุฏุฏ'
    finish_poll = 'โน ุชููู ูุธุฑุณูุฌ'
    create_new_course = "โ ุงุฑุงุฆู ุฏุฑุณ ุฌุฏุฏ"
    teacher_course_students = '<b>ูุงู ุฏุฑุณ</b>:{name}\n<b>ุชุนุฏุงุฏ ูุงุญุฏ</b>:{units}\n<b>ุชุนุฏุงุฏ ุฏุงูุดุฌู</b>:{students}\n<b>ุงุทูุงุนู</b>:{notif}\n<b>ุฑุง ฺฏุฑ</b>:{poll}\n\n'
    enter_marks = 'ูุทูุง ููุฑุงุช ุฏุงูุดุฌูุงู ุฏุฑุณ <b>{name}</b> ุฑุง ูุงุฑุฏ ฺฉูุฏ. \nุจุงุฏ ุฏุฑ ูุฑ ุฎุท ุงุจุชุฏุง ุดูุงุฑู ุฏุงูุดุฌูุ ุจุนุฏ ฺฉ ุฏู ููุทู ู ุจุนุฏ ุงุฒ ุขู ููุฑู ุขู ุฏุงูุดุฌู ุฑุง ูุงุฑุฏ ฺฉูุฏ. ูุซุงู:\n<pre>40013212101 : 20\n40013212102 : 16.5\n</pre>\n\nุจุฑุง ูุบู  ููุท ฺฉููู <b>/cancel</b> ุฑุง ุจูุฑุณุชุฏ.'
    enter_student_for_delete = 'ูุทูุง ุดูุงุฑู ุฏุงูุดุฌู ุงุฒ ุฏุฑุณ <b>{name}</b> ฺฉู ูุฎูุงูุฏ ุญุฐู ุดูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ. ุจุฑุง ูุบู  ููุท ฺฉููู <b>/cancel</b> ุฑุง ุจูุฑุณุชุฏ.'
    err_enter_new_marks = 'ููุฑุงุช ุฏุงูุดุฌูุงู ุฑุง ูุงุฑุฏ ฺฉูุฏ'
    err_enter_student_to_delete = 'ุดูุงุฑู ุฏุงูุดุฌู ฺฉู ุจุงุฏ ุญุฐู ุดูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ'
    canceled_successfully = "โ๏ธ ุนููุงุช ุจุง ููููุช ูุบู ุดุฏ"
    err_marks_no_colon = "ุฏุฑ ุฎุท <b>\"{line}\"</b> ุฏู ููุทู ูพุฏุง ูุดุฏ. ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ."
    err_s_id_is_invalid = "ุดูุงุฑู ุฏุงูุดุฌู ุฏุฑ ุฎุท <b>\"{line}\"</b> ูุง ูุนุชุจุฑ ุงุณุช ุง ุนุถู ุงู ฺฉูุงุณ ูุณุช. ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ."
    err_invalid_mark = "ููุฑู ุฏุงุฏู ุดุฏู ุฏุฑ ุฎุท <b>\"{line}\"</b> ูุง ูุนุชุจุฑ ุงุณุช. ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ."
    err_invalid_mark_range = "ููุฑู ุฏุงุฏู ุดุฏู ุฏุฑ ุฎุท <b>\"{line}\"</b> ุฎุงุฑุฌ ุงุฒ ุจุงุฒู 0 ุชุง 20 ุงุณุช. ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ."
    err_student_is_not_in_course = "ุดูุงุฑู ุฏุงูุดุฌู ุบูุท ุงุณุช ุง ุฏุงูุดุฌู ุนุถู ุงู ฺฉูุงุณ ูุณุช."
    student_deleted_successfully = "โ ุฏุงูุดุฌู ุจุง ููููุช ุญุฐู ุดุฏ."
    course_is_removed = 'ูุชุงุณูุงูู ุฏุฑุณ ููุฑุฏ ูุธุฑ ุญุฐู ุดุฏู ุงุณุช\n\start'
    already_has_poll = 'ุงู ุฏุฑุณ ุฏุฑ ุญุงู ุญุงุธุฑ ฺฉ ุฑุง ฺฏุฑ ูุนุงู ุฏุงุฑุฏ'
    enter_poll = 'ูุทูุง ุฏุฑ ุฎุท ุงูู ุนููุงู ุฑุง ฺฏุฑ ู ุฏุฑ ุฎุทูุท ุจุนุฏ ุฏุฑ ูุฑ ุฎุท ฺฉ ฺฏุฐูู ุจุฑุง ุงูุชุฎุงุจ ุชูุณุท ุฏุงูุดุฌูุงู ุฑุง ูุงุฑุฏ ฺฉูุฏ.'
    err_enter_poll_info = 'ุจุงุฏ ฺฉ ูุชู ุดุงูู ุงุทูุงุนุงุช ุฑุง ฺฏุฑ ุจูุฑุณุชุฏ'
    err_invalid_poll_info = 'ูุชู ุงุฑุณุงู ุจุงุฏ ุญุฏุงูู ุดุงูู ุณู ุฎุท ุจุงุดุฏุ ุฎุท ุงูู ุนููุงู ุฑุง ฺฏุฑ ู ุฏุฑ ุฏู ุฎุท ุจุนุฏ ูุชู ฺฏุฐูู ูุง ุงูู ู ุฏูู (ูุชูุงูุฏ ฺฏุฐูู ูุง ุจุดุชุฑ ุฏุฑ ุฎุทูุท ุจุนุฏ ูุฑุงุฑ ุฏูุฏ)'
    poll_created_successfully = 'ุฑุง ฺฏุฑ ุจุง ุนููุงู <b>\"{title}\"</b> ู {n} ฺฏุฐูู ุฏุฑ ุฏุณุชุฑุณ ุฏุงูุดุฌูุงู ุฏุฑุณ <b>\"{course}\"</b> ูุฑุงุฑ ฺฏุฑูุช. ุฏุงูุดุฌูุงู ุงุฒ ููู ุฏุฑุณ ุฏุฑ ุญุณุงุจ ฺฉุงุฑุจุฑ ุฎูุฏ ูุชูุงููุฏ ุฏุฑ ุฑุง ฺฏุฑ ุดุฑฺฉุช ฺฉููุฏ.'
    alert_for_new_poll = 'ุณูุงู ุดูุง ฺฉ ุฑุง ฺฏุฑ ุจุง ุนููุงู <b>\"{title}\"</b> ุฏุฑ ุฏุฑุณ <b>\"{course}\"</b> ุฏุงุฑุฏ. ุงุฒ ููู ุฏุฑุณ ูุชูุงูุฏ ุฏุฑ ุฑุง ฺฏุฑ ุดุฑฺฉุช ฺฉูุฏ.'
    participate_poll = 'ุดุฑฺฉุช ุฏุฑ ุฑุง ฺฏุฑ'
    enter_broadcast_text = "ูุทูุงู ูุชู ุงุทูุงุนู ุฑุง ูุงุฑุฏ ฺฉูุฏ ุจุฑุง ุญุฐู ฺฉุฑุฏู ุงุทูุงุนู ฺฉููู <b>\"ุญุฐู\"</b> ุฑุง ุจูุฑุณุชุฏ."
    you_have_new_notif = "ุดูุง ฺฉ ุงุทูุงุนู ุฌุฏุฏ ุฏุฑ ุฏุฑุณ <b>\"{course}\"</b> ุฏุงุฑุฏ."


class StudentState:
    main_menu = 0
    wait_for_enter_taking_course_id = 1
    wait_for_enter_message = 2


class TeacherState:
    main_menu = 0
    wait_for_enter_new_course_info = 1
    wait_for_enter_new_marks = 2
    wait_for_enter_delete_student = 3
    wait_for_enter_poll_info = 4
    wait_for_enter_broadcast_text = 5


def isfloat(num):
    try:
        float(num)
        return True
    except ValueError:
        return False


def persian_to_english(s):
    nums = [
        ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', ],
        ['ฐ', 'ฑ', 'ฒ', 'ณ', 'ด', 'ต', 'ถ', 'ท', 'ธ', 'น', ],
    ]
    for i in range(10):
        s = s.replace(nums[1][i], nums[0][i])
    return s


def override(_):
    return _

